<UserControl x:Class="Globe.Client.Localizer.Views.JobListManagementWindow"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:prism="http://prismlibrary.com/"
             xmlns:controls="http://schemas.controls.com/"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:platform="http://schemas.platform.com/"
             xmlns:models="clr-namespace:Globe.Client.Localizer.Models"
             prism:ViewModelLocator.AutoWireViewModel="True"
        mc:Ignorable="d" d:DesignHeight="450" d:DesignWidth="800">
    <UserControl.Resources>
        <platform:BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter" True="Visible" False="Collapsed" />
        <platform:BooleanToVisibilityConverter x:Key="InvertedBooleanToVisibilityConverter" True="Collapsed" False="Visible" />
        <Style TargetType="Panel" x:Key="SectionPanel">
            <Setter Property="Background" Value="WhiteSmoke" />
            <Setter Property="Margin" Value="3" />
        </Style>
        <Style TargetType="Panel" x:Key="BottomGridPanel">
            <Setter Property="Background" Value="WhiteSmoke" />
            <Setter Property="Margin" Value="1" />
            <Setter Property="DockPanel.Dock" Value="Bottom" />
        </Style>

        <Style TargetType="controls:LocButton" x:Key="treeViewItemButton" BasedOn="{StaticResource GrayButton}">
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="LightGray" />
                </Trigger>
                <Trigger Property="IsEnabled" Value="False">
                    <Setter Property="Opacity" Value="0.3" />
                </Trigger>
            </Style.Triggers>
            <Setter Property="Background" Value="Transparent" />
            <Setter Property="Margin" Value="0" />
            <Setter Property="Padding" Value="0" />
            <Setter Property="FontSize" Value="16" />
            <Setter Property="FontWeight" Value="ExtraBlack" />
            <Setter Property="MinWidth" Value="0" />
            <Setter Property="Width" Value="24" />
        </Style>
    </UserControl.Resources>

    <controls:LocDockPanel Style="{StaticResource LocDockPanelStyle}">
        <controls:LocGrid DockPanel.Dock="Left" Width="350" Style="{StaticResource SectionPanel}" Visibility="{Binding ShowFilters, Converter={StaticResource BooleanToVisibilityConverter}}">
            <Grid.RowDefinitions>
                <RowDefinition Height="auto" />
                <RowDefinition Height="auto" />
                <RowDefinition Height="auto" />
                <RowDefinition Height="*" />
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
                <ColumnDefinition />
                <ColumnDefinition />
            </Grid.ColumnDefinitions>

            <controls:LocLabel Style="{StaticResource LocLabelTitle}" Grid.ColumnSpan="2" Content="{Binding Localize[Filters]}"/>
            <controls:LocTextBlock Grid.Row="1" Grid.Column="0" Text="{Binding Localize[Language]}"/>
            <controls:LocComboBox  Grid.Row="1" Grid.Column="1" ItemsSource="{Binding Languages}" SelectedItem="{Binding SelectedLanguage}" DisplayMemberPath="Description" platform:SelectionChangedBehaviour.Command="{Binding LanguageChangeCommand}" ToolTip="{Binding SelectedLanguage.Description}" ToolTipService.InitialShowDelay="500"></controls:LocComboBox>
            <DockPanel Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="2" HorizontalAlignment="Stretch">
                <controls:LocTextBlock Text="{Binding Localize[Components]}" HorizontalAlignment="Left" />
                <DockPanel HorizontalAlignment="Right" Margin="3,3,4,0">
                    <controls:LocButton Content="&lt;&lt;" Style="{StaticResource treeViewItemButton}"
                                                Command="{Binding RemoveCommand}" ToolTip="{Binding Localize[Remove_the_selection]}" />
                    <controls:LocButton Content="-" Style="{StaticResource treeViewItemButton}"
                                                Command="{Binding RemoveAllCommand}" ToolTip="{Binding Localize[Remove_all_items]}" />
                    <controls:LocButton Content="+" Style="{StaticResource treeViewItemButton}"
                                                Command="{Binding AddAllCommand}" ToolTip="{Binding Localize[Add_all_items]}" />
                </DockPanel>
            </DockPanel>
            <ScrollViewer Grid.Row="3" Grid.ColumnSpan="2" VerticalScrollBarVisibility="Auto">
                <controls:LocGrid Style="{StaticResource SectionPanel}">
                    <controls:LocTreeView ItemsSource="{Binding ComponentNamespaceGroups}" HorizontalContentAlignment="Stretch" BorderThickness="0">
                        <controls:LocTreeView.ItemContainerStyle>
                            <Style TargetType="{x:Type TreeViewItem}" BasedOn="{StaticResource StretchedTreeViewItem}">
                                <Setter Property="IsSelected" Value="{Binding IsSelected}" />
                                <Style.Triggers>
                                    <Trigger Property="IsSelected" Value="True">
                                        <Setter Property="Background" Value="LightBlue" />
                                    </Trigger>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter Property="Background" Value="LightBlue" />
                                    </Trigger>
                                </Style.Triggers>
                            </Style>
                        </controls:LocTreeView.ItemContainerStyle>
                        <controls:LocTreeView.Resources>
                            <HierarchicalDataTemplate DataType="{x:Type models:BindableComponentNamespaceGroup}" ItemsSource="{Binding InternalNamespaces}">
                                <DockPanel Name="rootItem" Background="Transparent">
                                    <controls:LocTextBlock Text="{Binding ComponentNamespace.Description}" />
                                    <controls:LocTextBlock Text="[" Foreground="Blue" />
                                    <controls:LocTextBlock Text="{Binding Count}" Foreground="Blue" />
                                    <controls:LocTextBlock Text="]" Foreground="Blue" />
                                    <controls:LocButton
                                            HorizontalAlignment="Right"
                                            Visibility="{Binding ElementName=rootItem, Path=IsMouseOver, Converter={StaticResource BooleanToVisibilityConverter}}"
                                            Content="+"
                                            ToolTip="{Binding RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=UserControl}, Path=DataContext.Localize[Add_selected_group]}"
                                            Style="{StaticResource treeViewItemButton}"
                                            Command="{Binding RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=UserControl}, Path=DataContext.AddComponentNamespaceGroupCommand}"
                                            CommandParameter="{Binding}" />
                                </DockPanel>
                            </HierarchicalDataTemplate>
                            <DataTemplate DataType="{x:Type models:BindableInternalNamespace}">
                                <DockPanel Name="leafItem" Background="Transparent">
                                    <controls:LocTextBlock Text="{Binding Description}" />
                                    <controls:LocButton
                                                HorizontalAlignment="Right"
                                                Visibility="{Binding ElementName=leafItem, Path=IsMouseOver, Converter={StaticResource BooleanToVisibilityConverter}}"
                                                Content="+"
                                                ToolTip="{Binding RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=UserControl}, Path=DataContext.Localize[Add_selected_item]}"
                                                Style="{StaticResource treeViewItemButton}"
                                                Command="{Binding RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=UserControl}, Path=DataContext.AddInternalNamespaceCommand}"
                                                CommandParameter="{Binding}"/>
                                </DockPanel>
                            </DataTemplate>
                        </controls:LocTreeView.Resources>
                    </controls:LocTreeView>
                    <controls:LocTextBlock FontStyle="Italic" HorizontalAlignment="Center" Visibility="{Binding ComponentsVisible, Converter={StaticResource InvertedBooleanToVisibilityConverter}}" Text="{Binding Localize[NoComponents]}"></controls:LocTextBlock>
                </controls:LocGrid>
            </ScrollViewer>
            <platform:Spinner Grid.Row="1" Grid.RowSpan="5" Grid.ColumnSpan="2" Busy="{Binding FiltersBusy}" />
        </controls:LocGrid>
        <controls:LocDockPanel Style="{StaticResource LocDockPanelStyle}">
            <controls:LocGrid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="95*" />
                    <RowDefinition Height="auto"/>
                </Grid.RowDefinitions>
                <controls:LocDataGrid Grid.Row="0" ItemsSource="{Binding NotTranslatedConceptViews}" SelectedItem="{Binding SelectedNotTranslatedConceptView}" SelectionMode="Extended" IsReadOnly="true" AutoGenerateColumns="False" CanUserAddRows="False">
                    <DataGrid.Resources>
                        <Style TargetType="DataGridRow">
                            <Setter Property="IsSelected" Value="{Binding IsSelected}" />
                        </Style>
                    </DataGrid.Resources>
                    <DataGrid.Columns>
                        <DataGridTextColumn Binding="{Binding ComponentNamespace.Description}" Header="Component Namespace">
                            <DataGridTextColumn.HeaderTemplate>
                                <DataTemplate>
                                    <controls:LocTextBlock Style="{StaticResource DataGridHeaderTextBlock}" Text="{Binding Content, RelativeSource=
                                         {RelativeSource Mode=TemplatedParent}}"/>
                                </DataTemplate>
                            </DataGridTextColumn.HeaderTemplate>
                        </DataGridTextColumn>
                        <DataGridTextColumn Binding="{Binding InternalNamespace.Description}" Header="Internal Namespace">
                            <DataGridTextColumn.HeaderTemplate>
                                <DataTemplate>
                                    <controls:LocTextBlock Style="{StaticResource DataGridHeaderTextBlock}" Text="{Binding Content, RelativeSource=
                                         {RelativeSource Mode=TemplatedParent}}"/>
                                </DataTemplate>
                            </DataGridTextColumn.HeaderTemplate>
                        </DataGridTextColumn>
                        <DataGridTextColumn Binding="{Binding Name}" Header="Concept">
                            <DataGridTextColumn.HeaderTemplate>
                                <DataTemplate>
                                    <controls:LocTextBlock Style="{StaticResource DataGridHeaderTextBlock}" Text="{Binding Content, RelativeSource=
                                         {RelativeSource Mode=TemplatedParent}}"/>
                                </DataTemplate>
                            </DataGridTextColumn.HeaderTemplate>
                        </DataGridTextColumn>
                        <DataGridTemplateColumn IsReadOnly="True" Header="Contexts">
                            <DataGridTemplateColumn.HeaderStyle>
                                <Style TargetType="{x:Type DataGridColumnHeader}">
                                    <Setter Property="Template">
                                        <Setter.Value>
                                            <ControlTemplate TargetType="DataGridColumnHeader">
                                                <controls:LocDockPanel LastChildFill="False" Background="Transparent">
                                                    <controls:LocTextBlock DockPanel.Dock="Top">Contexts</controls:LocTextBlock>
                                                    <controls:LocGrid DockPanel.Dock="Bottom">
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition />
                                                        </Grid.ColumnDefinitions>
                                                        <controls:LocTextBlock Grid.Column="0">Name</controls:LocTextBlock>
                                                    </controls:LocGrid>
                                                </controls:LocDockPanel>
                                            </ControlTemplate>
                                        </Setter.Value>
                                    </Setter>
                                    <Setter Property="HorizontalContentAlignment" Value="Center" />
                                    <Setter Property="Foreground" Value="Black"/>
                                    <Setter Property="FontSize" Value="14"/>
                                    <Setter Property="FontWeight" Value="DemiBold"/>
                                    <Setter Property="MinWidth" Value="150"/>
                                </Style>
                            </DataGridTemplateColumn.HeaderStyle>
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <ItemsControl ItemsSource="{Binding ContextViews}">
                                        <ItemsControl.ItemsPanel>
                                            <ItemsPanelTemplate>
                                                <VirtualizingStackPanel />
                                            </ItemsPanelTemplate>
                                        </ItemsControl.ItemsPanel>
                                        <ItemsControl.ItemTemplate>
                                            <DataTemplate>
                                                <controls:LocGrid DockPanel.Dock="Bottom">
                                                    <controls:LocGrid.ColumnDefinitions>
                                                        <ColumnDefinition />
                                                    </controls:LocGrid.ColumnDefinitions>
                                                    <controls:LocTextBlock Grid.Column="0" Text="{Binding Name}" />
                                                </controls:LocGrid>
                                            </DataTemplate>
                                        </ItemsControl.ItemTemplate>
                                    </ItemsControl>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>
                    </DataGrid.Columns>
                </controls:LocDataGrid>
                <platform:Spinner Grid.Row="0" Diameter="60" Busy="{Binding ConceptDetailsBusy}" />
                <controls:LocDockPanel Grid.Row="1" DockPanel.Dock="Bottom" LastChildFill="True" Style="{StaticResource BottomGridPanel}">
                    <controls:LocTextBlock DockPanel.Dock="Right" Text="{Binding ItemCount}" TextAlignment="Left" FontSize="11" FontWeight="Bold"></controls:LocTextBlock>
                    <controls:LocTextBlock DockPanel.Dock="Right" TextAlignment="Right" Text="{Binding Localize[Items_Count]}" FontSize="11" FontWeight="Bold"></controls:LocTextBlock>
                </controls:LocDockPanel>
            </controls:LocGrid>
        </controls:LocDockPanel>
    </controls:LocDockPanel>

</UserControl>
